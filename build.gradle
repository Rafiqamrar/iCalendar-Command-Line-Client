plugins {
        id 'application'
        id 'jacoco'
}

application {
    mainClass = 'eirb.pg203.Main'
}

repositories {
        mavenCentral()
}

dependencies {
        testImplementation(platform('org.junit:junit-bom:5.11.2'))
        testImplementation('org.junit.jupiter:junit-jupiter')
        testRuntimeOnly('org.junit.platform:junit-platform-launcher')
}

test {
        useJUnitPlatform()
        testLogging {
                events "passed", "skipped", "failed"
        }
}

jar {
        manifest {
                attributes 'Main-Class': application.mainClass
        }
}

task clangFormat(type: Exec) {
    group = 'formatting'
    description = 'Format all Java files using clang-format with .clang-format config'
    
    workingDir project.rootDir
    commandLine 'sh', '-c', 'find . -name "*.java" -exec clang-format -i {} \\;'
}

task clangFormatCheck(type: Exec) {
    group = 'verification'
    description = 'Check Java files formatting using clang-format with .clang-format config'
    
    workingDir project.rootDir
    commandLine 'sh', '-c', 'find . -name "*.java" -exec clang-format --dry-run -Werror {} \\;'
}